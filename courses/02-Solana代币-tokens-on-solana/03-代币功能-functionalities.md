# 03-代币功能 - 代币能做什么？🛠️

嘿，小伙伴！👋

Token Program通过一组指令操作，让您可以：
- 创建代币铸造
- 初始化代币账户
- 在账户之间转移代币
- 管理权限

它还支持多签名账户以增强安全性，并提供冻结账户和委托代币权限的机制！

**比喻说明：** 就像银行的各种业务，转账、授权、冻结等等！

---

## 🎯 本章你会学到什么？

- ✅ 如何初始化Mint和Token账户
- ✅ 如何转移代币
- ✅ 如何授权和撤销代理
- ✅ 如何铸造和销毁代币
- ✅ 如何冻结和解冻账户

---

## 🏗️ 初始化账户

### 不同类型的初始化

Token Program提供了不同的指令和辅助工具，可以简化初始化新账户的复杂过程。

**根据账户类型不同：**
- **Mint账户** - 使用`initializeMint`指令
- **Token账户** - 使用`initializeAccount`指令
- **Associated Token账户** - Associated Token Program会自动处理

**Associated Token的magic：** 在推导出正确的Program Derived Address后，使用`initializeAccount`指令。

---

### 初始化前的准备

**小伙伴们要特别注意啦：**

> ⚠️ 此功能仅**初始化账户**，因此我们需要确保在此之前使用System Program的`createAccount()`指令！
> 
> 需要设置：
> - 正确的所有者（Token Program）
> - 正确的空间
> - 足够的lamports（使其免租金）

**比喻：** 就像开银行账户，先要去柜台开户（create），然后激活（initialize）！

---

## 💸 转移代币（Transfer）

### 基本操作

**作用：** 将代币从一个账户转移到另一个账户

**场景：** 这是用户之间发送代币的基本操作！

**要求：**
- ✅ 代币账户的所有者需要是该交易的`Signer`
- ✅ 转账的目标需要是另一个**代币账户**

**比喻：** 就像转账，必须本人签字（Signer），转到对方的银行账户！

---

### 小数位处理

**小伙伴们要特别注意啦：**

> ⚠️ 我们决定转移的金额**不包含小数位**！
> 
> 因此，如果我们想发送一个有6位小数的代币，我们需要使用`1e6`表示法。

**举例：**
- 代币小数位：6
- 想转移：1个代币
- 实际金额：1,000,000（1e6）

**比喻：** 就像人民币，1元=100分，转账时用"分"作单位！

---

## 👥 授权代理（Approve）

### 什么是代理？

**作用：** 授予代理权限，允许其代表账户所有者转移特定数量的代币

**好处：** 使得程序化的代币转移成为可能，而无需授予完整的账户控制权！

**机制：** 我们设置一个"批准"的金额，代理只能转移不超过该金额的资金

**比喻：** 就像给秘书授权，可以代你签字花钱，但有额度限制！

---

### 使用场景

**常见应用：**
- DEX（去中心化交易所）- 授权交易所代你卖代币
- DeFi协议 - 授权借贷协议操作你的代币
- 自动支付 - 授权程序定期扣款

---

## 🚫 撤销代理（Revoke）

### 取消授权

**作用：** 移除当前代理对账户的权限，将账户的完全控制权归还给账户所有者

**特性：**
- ⚡ 立即取消任何现有的代理权限
- 🔐 只有账户所有者可以撤销代理
- ❌ 代理本身无法撤销

**比喻：** 就像收回授权书，秘书立即失去签字权！

---

## 🔑 设置权限（SetAuthority）

### 权限转移

**作用：** 更改mint或账户的权限

**可更改的权限：**
- Mint权限
- 冻结权限
- 账户所有者

**小伙伴们要特别注意啦：**

> ⚠️ **永久操作警告**：将权限设置为`None`是一个**不可逆的操作**，会永久移除该功能！

**比喻：** 就像公司换法人，新法人上任，旧法人失去权力。如果设为None，就是解散公司，永远不能再恢复！

---

### 使用场景

**何时更改权限？**
1. **转移所有权** - 卖出项目
2. **去中心化** - 设为None，让代币完全去中心化
3. **升级安全** - 换到多签账户

---

## 🪙 铸造代币（MintTo）

### 创建新代币

**作用：** 创建新代币并将其存入指定账户

**权限要求：** 只有**mint权限持有者**可以执行此操作！

**效果：**
- 增加代币的总供应量
- 金额遵循mint的小数配置

**比喻：** 就像央行印钞票，只有央行（mint authority）能印！

---

### 使用场景

**何时铸造？**
- 初始发行
- 增发（如果设计允许）
- 奖励分发

---

## 🔥 销毁代币（Burn）

### 永久移除

**作用：** 通过从流通中移除代币来**永久销毁**代币

**效果：** 减少代币的总供应量

**权限：** 此操作可以由账户所有者或代理执行

**比喻：** 就像烧钞票，永久减少流通量！

---

### 使用场景

**为什么要销毁？**
- 通缩机制（减少供应，提高价值）
- 回购销毁（项目买回代币后销毁）
- NFT升级（销毁旧的，铸造新的）

---

## 🚪 关闭账户（CloseAccount）

### 回收租金

**作用：** 关闭一个代币账户并将其剩余的SOL租金转移到目标账户

**要求：** 代币账户必须**余额为零**，除非它是一个原生SOL账户

**从Token2022开始的新功能：**

> ✅ 可以关闭供应量为0的`Mint`账户！

**比喻：** 就像注销银行账户，拿回押金！

---

### 何时关闭账户？

**场景：**
- 不再需要某个代币
- 清理无用账户
- 回收存储的SOL

---

## ❄️ 冻结账户（FreezeAccount）

### 锁定操作

**作用：** 阻止账户上的**所有**代币操作，直到账户被解冻

**权限：** 只有mint的**冻结权限持有者**可以执行此操作

**影响：** 完全禁用：
- ❌ 转账
- ❌ 授权
- ❌ 销毁

**范围：** 仅影响特定被冻结的账户

**比喻：** 就像银行冻结账户，所有操作都被禁止！

---

### 使用场景

**何时冻结？**
- 发现可疑活动
- 法律要求
- 防止盗窃

---

## 🌡️ 解冻账户（ThawAccount）

### 恢复操作

**作用：** 重新启用先前被冻结账户的代币操作

**权限：** 只有铸币的**冻结权限方**可以解冻账户

**效果：** 恢复被冻结账户的全部功能

**比喻：** 就像解冻银行账户，恢复正常使用！

---

## 📊 功能总结表

| 功能 | 作用 | 权限要求 | 影响 |
|------|------|---------|------|
| 初始化 | 创建账户 | 任何人 | 新账户 |
| 转移 | 发送代币 | 所有者 | 余额变化 |
| 授权 | 委托权限 | 所有者 | 代理获权 |
| 撤销 | 取消委托 | 所有者 | 代理失权 |
| 设置权限 | 更改权限 | 当前权限方 | 权限转移 |
| 铸造 | 创建代币 | Mint权限 | 供应增加 |
| 销毁 | 移除代币 | 所有者/代理 | 供应减少 |
| 关闭 | 销账户 | 所有者 | 回收租金 |
| 冻结 | 锁定账户 | 冻结权限 | 禁止操作 |
| 解冻 | 解锁账户 | 冻结权限 | 恢复操作 |

---

## 💡 学习建议

### 本章重点回顾

**必须掌握：**
1. ✓ 转移代币的基本操作
2. ✓ 授权和撤销的概念
3. ✓ 铸造和销毁的作用
4. ✓ 关闭账户的要求

**了解即可：**
- 冻结/解冻（特殊场景使用）
- 设置权限的细节

---

## 🎯 下一步

学完这一章，你应该：

- ✓ 理解Token Program的核心功能
- ✓ 知道每个操作的权限要求
- ✓ 了解使用场景

**准备好了吗？** 下一章我们将学习**Metaplex代币元数据程序**！

---

**现在小伙伴们懂了吧？** Token Program就像功能齐全的银行系统！🛠️

---

**最后更新**：2026年1月9日  
**制作人**：bruceCao  
**学习建议**：每个功能都很重要，建议结合实践理解！