# 09-å¤æ´»æ”»å‡» - é˜²æ­¢åƒµå°¸è´¦æˆ·ï¼ğŸ§Ÿ

å˜¿ï¼Œå°ä¼™ä¼´ï¼ğŸ‘‹

**å¤æ´»æ”»å‡»**å…è®¸æ”»å‡»è€…"å¤æ´»"å·²å…³é—­çš„è´¦æˆ·ï¼Œé‡æ–°ä½¿ç”¨å®ƒä»¬ï¼

**æ¯”å–»è¯´æ˜ï¼š** å°±åƒå·²ç»æ³¨é”€çš„é“¶è¡Œå¡åˆè¢«æ¿€æ´»ï¼

---

## ğŸ¯ ä»€ä¹ˆæ˜¯å¤æ´»æ”»å‡»ï¼Ÿ

**é—®é¢˜ï¼š** å…³é—­è´¦æˆ·åï¼Œæ²¡æœ‰æ­£ç¡®æ¸…ç†discriminatorã€‚

**å±é™©ï¼š** æ”»å‡»è€…å¯ä»¥ï¼š
- é‡æ–°ä½¿ç”¨å·²å…³é—­è´¦æˆ·
- ç»•è¿‡åˆå§‹åŒ–æ£€æŸ¥
- è®¿é—®æ—§æ•°æ®

---

## âš ï¸ æ¼æ´ç¤ºä¾‹

```rust
pub fn close(ctx: Context<Close>) -> Result<()> {
    // âŒ åªè½¬ç§»äº†lamportsï¼Œæ²¡æ¸…ç†æ•°æ®
    **ctx.accounts.user.lamports.borrow_mut() += 
        ctx.accounts.data.to_account_info().lamports();
    **ctx.accounts.data.to_account_info().lamports.borrow_mut() = 0;
    Ok(())
}
```

---

## âœ… æ­£ç¡®åšæ³•

**æ–¹æ³•1ï¼šæ¸…é›¶discriminator**

```rust
// è®¾ç½®discriminatorä¸ºç‰¹æ®Šå€¼
ctx.accounts.data.discriminator = [255; 8];
```

**æ–¹æ³•2ï¼šä½¿ç”¨Anchorçš„closeçº¦æŸ**

```rust
#[account(mut, close = user)]
pub data: Account<'info, Data>,
```

**Anchorä¼šè‡ªåŠ¨ï¼š**
- è½¬ç§»lamports
- æ¸…é›¶discriminator

---

**ç°åœ¨å°ä¼™ä¼´ä»¬æ‡‚äº†å§ï¼Ÿ** æ­£ç¡®å…³é—­è´¦æˆ·å¾ˆé‡è¦ï¼ğŸ§Ÿ

---

**æœ€åæ›´æ–°**ï¼š2026å¹´1æœˆ9æ—¥  
**åˆ¶ä½œé£æ ¼**ï¼šè«å¼é£æ ¼